<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ePay</title>
  <link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
/>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
    crossorigin="anonymous"
  />
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;700;900&family=Roboto:wght@400;500;900&family=Ubuntu:wght@300&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;700;900&family=Open+Sans:wght@500&family=Roboto:wght@400;500;900&family=Ubuntu:wght@300&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style/style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;700;900&family=Open+Sans:wght@500&family=Roboto:wght@400;500;900&family=Ubuntu:wght@300&display=swap" rel="stylesheet">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;700;900&family=Open+Sans:wght@500&family=Poppins:wght@500&family=Roboto:wght@400;500;900&family=Ubuntu:wght@300&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;700;900&family=Nanum+Gothic&family=Open+Sans:wght@500&family=Poppins:wght@500&family=Roboto:wght@400;500;900&family=Ubuntu:wght@300&display=swap" rel="stylesheet">
  
</head>
<body>
  <div class="header bg-success">
    <div class="container">
      <ul>
        <div class="row">
          <div class="col-md-2">
            <li class="esewa-brand">
              <a href="https://esewa.com.np/#/home"><img src="image/esewa_logos.png" alt="esewa logo" width="100px" height="20px"></a>
            </li>
          </div>
          <div class="col-md-2">
            <li>
              <a href="index.html">Introduction</a>
            </li>
          </div>
          <div class="col-md-1">
            <li>
              <a href="epay.html">Epay</a>
            </li>
          </div>
          <div class="col-md-1">
            <li>
              <div class="dropdown">
                <button class="dropbtn">SDK</button>
                <div class="dropdown-content">
                <a href="#">Andriod</a>
                <a href="#">IOS</a>
                <a href="#">Flutter</a>
                </div>
              </div>
              
            </li>
          </div>

          <div class="col-md-2">
            <li>
              <a href="#">WooCommerce</a>
            </li>
          </div>
          <div class="col-md-2">
            <li>
              <a href="#">Token payment</a>
            </li>
          </div>
          <div class="col-md-2">
            <input type="text" placeholder="Search">
            </input>
            
            
          </div>
          
        </div>
      </ul>
    </div>
  </div>


  <div class="epay-content">
    <div class="container">
      <div class="row">
        <div class="col-md-10">
          <h4>Overview</h4>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p class="epay-content-para">The eSewa ePay system enables partner merchant to perform transaction and receive money from customer having eSewa account in secure environment.</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <h6>Transaction Flow </h6>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <ol type="i">
            <li><p class="epay-content-para">When user choses eSewa as on-line payment option from partner merchant application, then user is temporarily redirected to eSewa ePay login page.</p></li>
            <li><p class="epay-content-para">User will provide valid credentials on login page.</p></li>
            <li><p class="epay-content-para">he transaction details sent by partner merchants.</p></li>
            <li><p class="epay-content-para">After each successful transaction, the user is redirected back to partner merchant’s success page. If transaction fails due to any reason (which includes user canceling transaction), the user is informed by appropriate failure message and redirected back to partner merchant’s failure page.</p></li>
            <li><p class="epay-content-para">For every successful transaction, the merchant account is credited accordingly and notified via email/SMS regarding transaction.</p></li>
            <li><p class="epay-content-para">eSewa application will automatically notifies partner merchant related to eSewa transaction through Instant Payment Notification (IPN).</p></li>
            <li><p class="epay-content-para">Partner merchants need to invoke transaction verification request to verify potential fraudulent transactions occurre</p></li>
            <li><p class="epay-content-para">eSewa application will automatically notifies partner merchant with either success or failure response.</p></li>
        </ol>
        </div>
      </div>
        
      <div class="row">
        <div class="col-md-10">
          <h6>System Interaction</h6>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <p class="epay-content-para">The interactions required to complete a transaction followed by transaction verification process are shown below:</p>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <div class="epay-content-image">
            <img src="image/apiDiagram.png" alt="diagram" width="50%" height="50%" >
            <p>Fig: System interaction for payment with transaction verification process</p>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <p class="epay-content-para">What actually happens in the figure is , first user makes a transaction on merchant website .When user select e-Sewa as e-payment gateway then user will get redirect to the esewa login page where user have to fill up their credentials. After that sucess page or failure page will be directed on the merchant site per transaction with the merchant. Esewa will send notification to the user about the amount being deducted.Esewa will verify the amount being received by the merchant .Merchant will request transaction verification and at end esewa will verify transaction response.</p>
        </div>
      </div>

    </div>
  </div>

  <div class="system-interaction">
    <div class="container">
      <div class="row">
        <div class="col-md-10">
          <h4>Implementation</h4>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p>eSewa ePay system integration on partner merchant’s application is the process of implementing eSewa as payment option. The integration process itself is performed in two phases, namely :</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <h6>Development and staging environment</h6>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p>The development and testing activities are carried out on <span class="system-para-anchor"> URL:<a href="https://uat.esewa.com.np/#/home">{https://uat.esewa.com.np}</a></span></p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p>This phase is intended to test process flow, transactions and other integration results. A test eSewa Id with password will be provided to the partner merchant to complete the transaction.</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <div class="system-interaction-note">
            <p class="system-remove-padding">
              <span style="font-style:italic">Note:</span>Test server may be taken off-line for maintenance or other technical reasons, during which users will receive “Service Temporarily Unavailable” message or any other message. In such case, please try again later or contact eSewa staff regarding issue.
            </p></div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p class="system-para-padded">The primary objective of this stage are:</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <ul>
            <li>
              Whether merchant requests are getting posted onto eSewa ePay system or not.</li>
            <li>Whether merchant is getting response of either a successful or failure transaction on their site.</li>
            <li>Implementation and testing of verification process.</li>
          </ul>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <h6>Producton Environment</h6>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p>The production transaction is carried out on <span class="system-para-anchor">URL:<a href="https://esewa.com.np/">{ https://esewa.com.np }</a></span></p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p>After successful testing phase, the partner merchant will be provided with merchant code for production environment credentials on request.</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p>Partner merchant’s have to modify the request URL and point toward production server and use production environment merchant credentials. Then, partner merchant will be able to start accepting payments using eSewa ePay payment gateway.</p>
        </div>
      </div>    
    </div>
  </div>

  <div class="integration">
    <div class="container">
      <div class="row">
        <div class="col-md-10">
          
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <h4>Integration</h4>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <h6>Pre-requisite</h6>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p>It is required for merchant to provide eSewa with two email ids. Those emails will be used for creating merchant and end user in test environment.
          </p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <p>During this phase, merchant will use test user credentials to login in eSewa and process the transaction. Adequate balance will be updated to test user account.</p>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <h5>Payment</h5>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <p>{URI: /epay/main }</p>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <span class="payment-span">The partner merchant will send transaction request to URL provided by eSewa with various parameters. Some of those parameters are required while others are optional. All parameters must not be empty or null. Optional parameters not used should have default value set.</span>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <span class="payment-span">Esewa will perform validation to check whether request parameters value are correct and in format. Validation failure will result to failure response and message, ending transaction process.</span>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <p class="integration-para-last">Request Sample Snippet</p>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <p class="payment-span3">HTML</p>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <div class="integration-background">
            <pre>&lt;body&gt;
              &lt;form action ="https://uat.esewa.com.np/epay/main" method="POST" &gt;
              &lt;input value="100" name="tAmt" type="hidden"&gt;
              &lt;input value="90" name="amt" type="hidden"&gt;
              &lt;input value="5" name="txAmt" type="hidden"&gt;
              &lt;input value="2" name="psc" type="hidden"&gt;
              &lt;input value="3" name="pdc" type="hidden"&gt;
              &lt;input value="EPAYTEST" name="scd" type="hidden"&gt;
              &lt;input value="ee2c3ca1-696b-4cc5-a6be-2c40d929d453" name="pid" type="hidden"&gt;
              &lt;input value="http://merchant.com.np/page/esewa_payment_success?q=su" type="hidden" name="su"&gt;
              &lt;input value="http://merchant.com.np/page/esewa_payment_failed?q=fu" type="hidden" name="fu"&gt;
              &lt;input value="Submit" type="submit"&gt;
              &lt;/form&gt;
            &lt;/body&gt;
            </pre>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-10">
          <p class="payment-span3">JAVASCRIPT </p>
        </div>
      </div>

     <div class="row">
      <div class="col-md-10">
        <div class="integration-background">
          <pre>
  var path="https://uat.esewa.com.np/epay/main";
  var params= {
      amt: 100,
      psc: 0,
      pdc: 0,
      txAmt: 0,
      tAmt: 100,
      pid: "ee2c3ca1-696b-4cc5-a6be-2c40d929d453",
      scd: "EPAYTEST",
      su: "http://merchant.com.np/page/esewa_payment_success",
      fu: "http://merchant.com.np/page/esewa_payment_failed"
  }
  
  function post(path, params) {
      var form = document.createElement("form");
      form.setAttribute("method", "POST");
      form.setAttribute("action", path);
  
      for(var key in params) {
          var hiddenField = document.createElement("input");
          hiddenField.setAttribute("type", "hidden");
          hiddenField.setAttribute("name", key);
          hiddenField.setAttribute("value", params[key]);
          form.appendChild(hiddenField);
      }
  
      document.body.appendChild(form);
      form.submit();
  }
            
          </pre>
        </div>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10">
        <p class="text-danger">PYTHON</p>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10">
        <div class="integration-background">
          <pre>
  
            url ="https://uat.esewa.com.np/epay/main"
            d = {'amt': 100,
                'pdc': 0,
                'psc': 0,
                'txAmt': 0,
                'tAmt': 100,
                'pid':'ee2c3ca1-696b-4cc5-a6be-2c40d929d453',
                'scd':'EPAYTEST',
                'su':'http://merchant.com.np/page/esewa_payment_success?q=su',
                'fu':'http://merchant.com.np/page/esewa_payment_failed?q=fu'}
            resp = req.post(url, d)
            
          </pre>
        </div>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10">
        <p class="text-danger">PHP</p>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10">
        <div class="integration-background">
          <pre>
  
            $url = "https://uat.esewa.com.np/epay/main";
            $data =[
                'amt'=> 100,
                'pdc'=> 0,
                'psc'=> 0,
                'txAmt'=> 0,
                'tAmt'=> 100,
                'pid'=>'ee2c3ca1-696b-4cc5-a6be-2c40d929d453',
                'scd'=> 'EPAYTEST',
                'su'=>'http://merchant.com.np/page/esewa_payment_success?q=su',
                'fu'=>'http://merchant.com.np/page/esewa_payment_failed?q=fu'
            ]
            
                $curl = curl_init($url);
                curl_setopt($curl, CURLOPT_POST, true);
                curl_setopt($curl, CURLOPT_POSTFIELDS, $data);
                curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
                $response = curl_exec($curl);
                curl_close($curl);
            
          </pre>
        </div>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10">
        <p>Request Details</p>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10">
        <table>
          <tr>
            <th class="text-center">Parameter Name</th>
            <th class="ps-3">Description</th>
          </tr>
          <tr>
              <td class="text-danger text-center">amt</td>
              <td class="ps-3">Amount of product or item or ticket etc</td>
          </tr>
          <tr>
            <td class="text-danger text-center">txAmt</td>
            <td class="ps-3">Tax amount on product or item or ticket etc</td>
          </tr>
          <tr>
            <td class="text-danger text-center">psc</td>
            <td class="ps-3">Service charge by merchant on product or item or ticket etc</td>
          </tr>
          <tr>
            <td class="text-danger text-center">pdc</td>
            <td class="ps-3">	Delivery charge by merchant on product or item or ticket etc</td>
          </tr>
          <tr>
            <td class="text-danger text-center">tAmt</td>
            <td class="ps-3">Total payment amount including tax, service and deliver charge. [i.e tAmt = amt + txAmt + psc + tAmt]</td>
          </tr>
          <tr>
            <td class="text-danger text-center">pid</td>
            <td class="ps-3">A unique ID of product or item or ticket etc</td>
          </tr>
          <tr>
            <td class="text-danger text-center">scd</td>
            <td class="ps-3">scd	Merchant code provided by eSewa</td>
          </tr>
          <tr>
            <td class="text-danger text-center">su</td>
            <td class="ps-3">Success URL: a redirect URL of merchant application where customer will be redirected after SUCCESSFUL transaction</td>
          </tr>
          <tr>
            <td class="text-danger text-center">fu</td>
            <td class="ps-3">Failure URL: a redirect URL of merchant application where customer will be redirected after FAILURE or PENDING transaction</td>
          </tr>
        </table>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10 pt-4">
        <div class="integration-background">
          <p>All parameters are required i.e. values should not be null or empty. If txAmt, psc & pdc are not used for transaction then their respective values should be zero.</p>
        </div>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10 pt-4">
        <div class="integration-background">
          <p>Redirect URI su and fu must start with http:// or https:// protocol.</p>
        </div>
      </div>
     </div>
     <div class="row">
      <div class="col-md-10">
        <p>For every successful transaction, eSewa will redirect user to success URI provided by partner merchant. The redirected URI will contain response query string.

        </p>
      </div>
     </div>
     
     <div class="row">
      <div class="col-md-10">
        <p>Response Snippet
        </p>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10">
        <p>For Successful Payment</p>
      </div>
     </div>
     
     <div class="row">
      <div class="col-md-10">
        <div class="integration-background-green mb-4">
          <a href="http://merchant.com.np/page/esewa_payment_success?q=su&oid=ee2c3ca1-696b-4cc5-a6be-2c40d929d453&amt=100&refId=000AE01

          ">http://merchant.com.np/page/esewa_payment_success?q=su&oid=ee2c3ca1-696b-4cc5-a6be-2c40d929d453&amt=100&refId=000AE01</a>
        </div>
      </div>
     </div>

     <div class="row mb-3">
      <div class="col-md-10">
        <table>
          <tr>
            <th class="text-center ps-3 pe-3">Parameter</th>
            <th class="p">Description</th>
          </tr>
          <tr>
            <td class="text-center text-danger">oid</td>
            <td>Product ID (pid) used on payment request</td>
          </tr>
          <tr>
            <td class="text-center text-danger">amt</td>
            <td>Total payment amount (tAmt)</td>
          </tr>
          <tr>
            <td class="text-center text-danger">refId</td>
            <td>A unique payment reference code generated by eSewa</td>
          </tr>
        </table>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10">
        <p>For Failed or Pending Payment</p>
      </div>
     </div>

     <div class="row">
      <div class="col-md-10">
        <div class="integration-background-green">
          <a href="http://merchant.com.np/page/esewa_payment_failure">http://merchant.com.np/page/esewa_payment_failure</a>
        </div>
      </div>
     </div>

  </div>
</div>


  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"
  ></script>

  </body>
  </html>
